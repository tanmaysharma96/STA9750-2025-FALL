<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.22">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tanmay Sharma">

<title>AfDB Awarded Contracts – STA 9750 Submission Material</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-cd7454b418030687c631a6a7286fbe16.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-029b10fc0dc652dab2ec1ac156c1a037.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">STA 9750 Submission Material</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#method-mix-vs-value" id="toc-method-mix-vs-value" class="nav-link active" data-scroll-target="#method-mix-vs-value"><span class="header-section-number">1</span> Method Mix vs Value</a>
  <ul class="collapse">
  <li><a href="#method-mix-vs-value-by-procurement-mode" id="toc-method-mix-vs-value-by-procurement-mode" class="nav-link" data-scroll-target="#method-mix-vs-value-by-procurement-mode"><span class="header-section-number">1.1</span> Method-mix vs value (by procurement mode)</a></li>
  <li><a href="#contract-size-distribution-visual" id="toc-contract-size-distribution-visual" class="nav-link" data-scroll-target="#contract-size-distribution-visual"><span class="header-section-number">1.2</span> Contract-size distribution (visual)</a></li>
  <li><a href="#high-value-awards-under-lower-competition-methods-screening-list" id="toc-high-value-awards-under-lower-competition-methods-screening-list" class="nav-link" data-scroll-target="#high-value-awards-under-lower-competition-methods-screening-list"><span class="header-section-number">1.3</span> High-value awards under lower-competition methods (screening list)</a></li>
  <li><a href="#domestic-vs-cross-border-sourcing-country-view" id="toc-domestic-vs-cross-border-sourcing-country-view" class="nav-link" data-scroll-target="#domestic-vs-cross-border-sourcing-country-view"><span class="header-section-number">1.4</span> Domestic vs cross-border sourcing (country view)</a></li>
  <li><a href="#domestic-sourcing-by-expense-category" id="toc-domestic-sourcing-by-expense-category" class="nav-link" data-scroll-target="#domestic-sourcing-by-expense-category"><span class="header-section-number">1.5</span> Domestic sourcing by expense category</a></li>
  <li><a href="#cross-border-sourcing-trend" id="toc-cross-border-sourcing-trend" class="nav-link" data-scroll-target="#cross-border-sourcing-trend"><span class="header-section-number">1.6</span> Cross-border sourcing trend</a></li>
  <li><a href="#supplier-concentration-by-country" id="toc-supplier-concentration-by-country" class="nav-link" data-scroll-target="#supplier-concentration-by-country"><span class="header-section-number">1.7</span> Supplier concentration by country</a></li>
  <li><a href="#supplier-concentration-by-sector" id="toc-supplier-concentration-by-sector" class="nav-link" data-scroll-target="#supplier-concentration-by-sector"><span class="header-section-number">1.8</span> Supplier concentration by sector</a></li>
  <li><a href="#concentration-watchlist" id="toc-concentration-watchlist" class="nav-link" data-scroll-target="#concentration-watchlist"><span class="header-section-number">1.9</span> Concentration watchlist</a></li>
  <li><a href="#repeat-award-patterns-countrysector" id="toc-repeat-award-patterns-countrysector" class="nav-link" data-scroll-target="#repeat-award-patterns-countrysector"><span class="header-section-number">1.10</span> Repeat-award patterns (country/sector)</a></li>
  <li><a href="#project-level-incumbency-dominance" id="toc-project-level-incumbency-dominance" class="nav-link" data-scroll-target="#project-level-incumbency-dominance"><span class="header-section-number">1.11</span> Project-level incumbency / dominance</a></li>
  <li><a href="#supplier-footprint-breadth-vs-dependence" id="toc-supplier-footprint-breadth-vs-dependence" class="nav-link" data-scroll-target="#supplier-footprint-breadth-vs-dependence"><span class="header-section-number">1.12</span> Supplier footprint (breadth vs dependence)</a></li>
  <li><a href="#contract-fragmentation-by-projectloan" id="toc-contract-fragmentation-by-projectloan" class="nav-link" data-scroll-target="#contract-fragmentation-by-projectloan"><span class="header-section-number">1.13</span> Contract fragmentation by project/loan</a></li>
  <li><a href="#near-threshold-clustering-spike-detection" id="toc-near-threshold-clustering-spike-detection" class="nav-link" data-scroll-target="#near-threshold-clustering-spike-detection"><span class="header-section-number">1.14</span> Near-threshold clustering (spike detection)</a></li>
  <li><a href="#heaping-metric-quantitative-check" id="toc-heaping-metric-quantitative-check" class="nav-link" data-scroll-target="#heaping-metric-quantitative-check"><span class="header-section-number">1.15</span> Heaping metric (quantitative check)</a></li>
  <li><a href="#project-procurement-intensity" id="toc-project-procurement-intensity" class="nav-link" data-scroll-target="#project-procurement-intensity"><span class="header-section-number">1.16</span> Project procurement intensity</a></li>
  <li><a href="#project-complexity-index" id="toc-project-complexity-index" class="nav-link" data-scroll-target="#project-complexity-index"><span class="header-section-number">1.17</span> Project complexity index</a></li>
  <li><a href="#micro-contract-intensity" id="toc-micro-contract-intensity" class="nav-link" data-scroll-target="#micro-contract-intensity"><span class="header-section-number">1.18</span> Micro-contract intensity</a></li>
  <li><a href="#country-procurement-fingerprint-ghana" id="toc-country-procurement-fingerprint-ghana" class="nav-link" data-scroll-target="#country-procurement-fingerprint-ghana"><span class="header-section-number">1.19</span> Country procurement fingerprint — Ghana</a></li>
  <li><a href="#method-mix-within-priority-sectors" id="toc-method-mix-within-priority-sectors" class="nav-link" data-scroll-target="#method-mix-within-priority-sectors"><span class="header-section-number">1.20</span> Method mix within priority sectors</a></li>
  <li><a href="#supplier-nationality-mix" id="toc-supplier-nationality-mix" class="nav-link" data-scroll-target="#supplier-nationality-mix"><span class="header-section-number">1.21</span> Supplier nationality mix</a></li>
  <li><a href="#top-suppliers-and-footprint" id="toc-top-suppliers-and-footprint" class="nav-link" data-scroll-target="#top-suppliers-and-footprint"><span class="header-section-number">1.22</span> Top suppliers and footprint</a></li>
  <li><a href="#contract-size-distribution" id="toc-contract-size-distribution" class="nav-link" data-scroll-target="#contract-size-distribution"><span class="header-section-number">1.23</span> Contract size distribution</a></li>
  <li><a href="#integrity-probity-screening-registry-evidence-based" id="toc-integrity-probity-screening-registry-evidence-based" class="nav-link" data-scroll-target="#integrity-probity-screening-registry-evidence-based"><span class="header-section-number">1.24</span> Integrity / probity screening registry (evidence-based)</a></li>
  <li><a href="#currency-conversion-sanity-check-uac-usd" id="toc-currency-conversion-sanity-check-uac-usd" class="nav-link" data-scroll-target="#currency-conversion-sanity-check-uac-usd"><span class="header-section-number">1.25</span> Currency conversion sanity check (UAC → USD)</a></li>
  <li><a href="#procurement-supply-corridors-country-supplier-nationality" id="toc-procurement-supply-corridors-country-supplier-nationality" class="nav-link" data-scroll-target="#procurement-supply-corridors-country-supplier-nationality"><span class="header-section-number">1.26</span> Procurement supply corridors (country → supplier nationality)</a></li>
  <li><a href="#country-sourcing-profiles" id="toc-country-sourcing-profiles" class="nav-link" data-scroll-target="#country-sourcing-profiles"><span class="header-section-number">1.27</span> Country sourcing profiles</a></li>
  <li><a href="#network-view-who-supplies-whom" id="toc-network-view-who-supplies-whom" class="nav-link" data-scroll-target="#network-view-who-supplies-whom"><span class="header-section-number">1.28</span> Network view: who supplies whom</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">AfDB Awarded Contracts</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Tanmay Sharma </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          used (Mb) gc trigger (Mb) max used (Mb)
Ncells  608766 32.6    1370505 73.2   702028 37.5
Vcells 1123449  8.6    8388608 64.0  1927953 14.8</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">"C:/Users/tanma/Downloads/listing_of_awarded_contracts_from_2020_to_2025_-_october_2025 (3).xlsx"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>raw <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(path, <span class="at">skip =</span> <span class="dv">2</span>)  <span class="co"># &lt;-- KEY FIX</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>to_num <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.numeric</span>(x)) <span class="fu">return</span>(x)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">parse_number</span>(<span class="fu">as.character</span>(x))</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> raw <span class="sc">%&gt;%</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(<span class="sc">~</span> <span class="sc">!</span><span class="fu">all</span>(<span class="fu">is.na</span>(.)))) <span class="sc">%&gt;%</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">as.integer</span>(year),</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">spend_usd =</span> <span class="fu">to_num</span>(equiv_usd),</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">cont_uac  =</span> <span class="fu">to_num</span>(cont_am_uac),</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">project_def =</span> <span class="fu">str_squish</span>(<span class="fu">as.character</span>(project_def)),</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">loan_number =</span> <span class="fu">str_squish</span>(<span class="fu">as.character</span>(loan_number)),</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">bidder_name =</span> <span class="fu">str_squish</span>(<span class="fu">as.character</span>(bidder_name)),</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">bidder_nationality =</span> <span class="fu">str_squish</span>(<span class="fu">as.character</span>(bidder_nationality)),</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">project_country =</span> <span class="fu">str_squish</span>(<span class="fu">as.character</span>(project_country)),</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">sector =</span> <span class="fu">str_squish</span>(<span class="fu">as.character</span>(sector)),</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">proc_mode =</span> <span class="fu">str_squish</span>(<span class="fu">as.character</span>(proc_mode)),</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">expense_category =</span> <span class="fu">str_squish</span>(<span class="fu">as.character</span>(expense_category)),</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">domestic_award =</span> (<span class="fu">str_to_upper</span>(bidder_nationality) <span class="sc">==</span> <span class="fu">str_to_upper</span>(project_country))</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(year), <span class="sc">!</span><span class="fu">is.na</span>(spend_usd)) <span class="sc">%&gt;%</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">2020</span>, year <span class="sc">&lt;=</span> <span class="dv">2025</span>)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 18,121
Columns: 22
$ year               &lt;int&gt; 2020, 2020, 2020, 2021, 2021, 2021, 2021, 2021, 202…
$ project_def        &lt;chr&gt; "P-AO-AA0-010", "P-AO-AAF-002", "P-AO-AAF-002", "P-…
$ project_name       &lt;chr&gt; "EMERGENCY FOOD &amp; NUTRITION SECURITY", "ANGOLA FISH…
$ sector             &lt;chr&gt; "Agriculture", "Agriculture", "Agriculture", "Agric…
$ bidder_code        &lt;chr&gt; "9900055505", "9900044036", "9900056900", "99000547…
$ bidder_name        &lt;chr&gt; "World Vision International-Angola", "AMBIGEST", "0…
$ bidder_nationality &lt;chr&gt; "Angola", "Angola", "Angola", "Angola", "Angola", "…
$ expense_category   &lt;chr&gt; "SERVICES", "SERVICES", "WORKS", "SERVICES", "SERVI…
$ contract_title     &lt;chr&gt; "Service Provider for Goods and Service", "Supervis…
$ proc_mode          &lt;chr&gt; "SHL", "DNP", "NCB", "DNP", "DNP", "DNP", "DNP", "S…
$ project_country    &lt;chr&gt; "Angola", "Angola", "Angola", "Angola", "Angola", "…
$ contr_no           &lt;chr&gt; "5000057984", "5000060613", "5000060614", "50000613…
$ tender_num         &lt;chr&gt; "49813", "52240", "52241", "52860", "52861", "52862…
$ loan_number        &lt;chr&gt; "5000199005968", "2100150029045", "2100150029045", …
$ cont_am_uac        &lt;dbl&gt; 702005.84, 14660.16, 74386.08, 10130.82, 13814.76, …
$ equiv_usd          &lt;dbl&gt; 970754.74, 20272.51, 102863.30, 14591.12, 19896.98,…
$ x18                &lt;chr&gt; NA, "Rates used for conversion", "Source : ADB Curr…
$ x19                &lt;chr&gt; NA, NA, NA, "UAC", "1", "1", "1", "1", "1", "1", NA…
$ x20                &lt;chr&gt; NA, NA, NA, "USD", "1.38283", "1.4402699999999999",…
$ spend_usd          &lt;dbl&gt; 970754.74, 20272.51, 102863.30, 14591.12, 19896.98,…
$ cont_uac           &lt;dbl&gt; 702005.84, 14660.16, 74386.08, 10130.82, 13814.76, …
$ domestic_award     &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, FALSE, TR…</code></pre>
</div>
</div>
<section id="cleanup-chunk" class="level4" data-number="0.0.1">
<h4 data-number="0.0.1" class="anchored" data-anchor-id="cleanup-chunk"><span class="header-section-number">0.0.1</span> Cleanup Chunk</h4>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">matches</span>(<span class="st">"^x</span><span class="sc">\\</span><span class="st">d+$"</span>)) <span class="sc">%&gt;%</span>   <span class="co"># drops x18, x19, x20 etc</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">proc_mode =</span> <span class="fu">str_to_upper</span>(<span class="fu">str_squish</span>(proc_mode)),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">expense_category =</span> <span class="fu">str_to_upper</span>(<span class="fu">str_squish</span>(expense_category)),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sector =</span> <span class="fu">str_squish</span>(sector),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">project_country =</span> <span class="fu">str_squish</span>(project_country),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">bidder_nationality =</span> <span class="fu">str_squish</span>(bidder_nationality)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 18,121
Columns: 19
$ year               &lt;int&gt; 2020, 2020, 2020, 2021, 2021, 2021, 2021, 2021, 202…
$ project_def        &lt;chr&gt; "P-AO-AA0-010", "P-AO-AAF-002", "P-AO-AAF-002", "P-…
$ project_name       &lt;chr&gt; "EMERGENCY FOOD &amp; NUTRITION SECURITY", "ANGOLA FISH…
$ sector             &lt;chr&gt; "Agriculture", "Agriculture", "Agriculture", "Agric…
$ bidder_code        &lt;chr&gt; "9900055505", "9900044036", "9900056900", "99000547…
$ bidder_name        &lt;chr&gt; "World Vision International-Angola", "AMBIGEST", "0…
$ bidder_nationality &lt;chr&gt; "Angola", "Angola", "Angola", "Angola", "Angola", "…
$ expense_category   &lt;chr&gt; "SERVICES", "SERVICES", "WORKS", "SERVICES", "SERVI…
$ contract_title     &lt;chr&gt; "Service Provider for Goods and Service", "Supervis…
$ proc_mode          &lt;chr&gt; "SHL", "DNP", "NCB", "DNP", "DNP", "DNP", "DNP", "S…
$ project_country    &lt;chr&gt; "Angola", "Angola", "Angola", "Angola", "Angola", "…
$ contr_no           &lt;chr&gt; "5000057984", "5000060613", "5000060614", "50000613…
$ tender_num         &lt;chr&gt; "49813", "52240", "52241", "52860", "52861", "52862…
$ loan_number        &lt;chr&gt; "5000199005968", "2100150029045", "2100150029045", …
$ cont_am_uac        &lt;dbl&gt; 702005.84, 14660.16, 74386.08, 10130.82, 13814.76, …
$ equiv_usd          &lt;dbl&gt; 970754.74, 20272.51, 102863.30, 14591.12, 19896.98,…
$ spend_usd          &lt;dbl&gt; 970754.74, 20272.51, 102863.30, 14591.12, 19896.98,…
$ cont_uac           &lt;dbl&gt; 702005.84, 14660.16, 74386.08, 10130.82, 13814.76, …
$ domestic_award     &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, FALSE, TR…</code></pre>
</div>
</div>
</section>
<section id="method-mix-vs-value" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="method-mix-vs-value"><span class="header-section-number">1</span> Method Mix vs Value</h2>
<p>Goal: distribution of contract sizes by procurement mode, plus total USD share, plus high-value under low-competition list</p>
<p>2A) Percentile table by proc_mode (P25/P50/P75/P90) + total USD share</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>pct_tbl <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(proc_mode) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">awards =</span> <span class="fu">n</span>(),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">usd_total =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">usd_share =</span> usd_total <span class="sc">/</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">p25 =</span> <span class="fu">quantile</span>(spend_usd, <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">p50 =</span> <span class="fu">quantile</span>(spend_usd, <span class="fl">0.50</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">p75 =</span> <span class="fu">quantile</span>(spend_usd, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">p90 =</span> <span class="fu">quantile</span>(spend_usd, <span class="fl">0.90</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(usd_total))</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>pct_tbl</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 8
  proc_mode awards   usd_total usd_share    p25     p50      p75      p90
  &lt;chr&gt;      &lt;int&gt;       &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 ICB         2926 9934783497.         1 89659. 344906. 1976985. 8343540.
2 NCB         7096 2220243220.         1 33278.  86968.  266434.  669300.
3 SHL         4107  966214899.         1 19089.  46162.  148692.  447844.
4 DNP         2022  706594585.         1 14179.  46608.  175603.  619111.
5 ISH          461  683830153.         1 23307.  68669.  263921. 2370568.
6 NSH         1295  126289122.         1 16118.  34511.   89574.  210133.
7 LIC          197   37515495.         1 12144.  31359.  118234.  423235.
8 &lt;NA&gt;          17    3378173.         1 32013.  55010.  108700.  181029.</code></pre>
</div>
</div>
<section id="method-mix-vs-value-by-procurement-mode" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="method-mix-vs-value-by-procurement-mode"><span class="header-section-number">1.1</span> Method-mix vs value (by procurement mode)</h3>
<ul>
<li>Procurement modes differ strongly by <strong>typical contract size</strong> (P50) and <strong>upper-tail size</strong> (P90), which is where governance and VfM stakes are highest.</li>
<li>The <strong>USD share</strong> column shows which methods carry most of the portfolio’s value (not just volume), helping assess whether high-value contracting is concentrated in appropriately competitive methods.</li>
</ul>
<p>2B) Boxplot/violin of award sizes by proc_mode (log scale)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> proc_mode, <span class="at">y =</span> spend_usd)) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">outlier.alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>()) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Award Size Distribution by Procurement Mode (log scale)"</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Procurement mode"</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Award size (USD, log scale)"</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AfDB_Awarded_Contracts_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="contract-size-distribution-visual" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="contract-size-distribution-visual"><span class="header-section-number">1.2</span> Contract-size distribution (visual)</h3>
<ul>
<li>The log-scale plot makes the <strong>long right tail</strong> visible: a small number of high-value awards can sit far above the typical range.</li>
<li>Modes with systematically higher distributions (higher median and wider upper tail) are the ones to scrutinize for whether competition levels align with value.</li>
</ul>
<p>2C) “High-value under non-competitive” list</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>low_comp_modes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DNP"</span>, <span class="st">"SHL"</span>)  <span class="co"># adjust later if needed</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>high_value_noncomp <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(proc_mode <span class="sc">%in%</span> low_comp_modes) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(spend_usd)) <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    year, project_country, sector, expense_category, proc_mode,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    bidder_name, bidder_nationality,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    project_def, loan_number, tender_num, contr_no,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    spend_usd</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">50</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>high_value_noncomp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 12
    year project_country sector          expense_category proc_mode bidder_name 
   &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;            &lt;chr&gt;     &lt;chr&gt;       
 1  2024 Cameroon        Transport       WORKS            DNP       SINOHYDRO C…
 2  2024 Tunisia         Agriculture     GOODS            SHL       GROUPE CHIM…
 3  2022 Cameroon        Transport       WORKS            DNP       Sinohydro C…
 4  2024 Namibia         Water Sup/Sanit WORKS            DNP       China Harbo…
 5  2022 Multi-Countries Transport       WORKS            SHL       China Henan…
 6  2020 Senegal         Transport       WORKS            SHL       CHINA RAILW…
 7  2024 Senegal         Transport       WORKS            SHL       LA SOCIETE …
 8  2022 Cameroon        Transport       WORKS            DNP       Sinohydro C…
 9  2022 South Africa    Power           WORKS            DNP       Amulet Grou…
10  2022 Congo CG        Communications  WORKS            SHL       CONSORTIUM …
# ℹ 40 more rows
# ℹ 6 more variables: bidder_nationality &lt;chr&gt;, project_def &lt;chr&gt;,
#   loan_number &lt;chr&gt;, tender_num &lt;chr&gt;, contr_no &lt;chr&gt;, spend_usd &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="high-value-awards-under-lower-competition-methods-screening-list" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="high-value-awards-under-lower-competition-methods-screening-list"><span class="header-section-number">1.3</span> High-value awards under lower-competition methods (screening list)</h3>
<ul>
<li>This list flags the <strong>largest awards</strong> executed under DNP, SHL.</li>
<li>These are not automatically non-compliant, but they are the most efficient starting point for follow-up questions on justification, approvals, and documentation quality.</li>
</ul>
<ol start="3" type="1">
<li>Domestic vs Cross-Border Sourcing</li>
</ol>
<p>3A) Country League Table (Domestic vs Cross-Border Share)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dom_country <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_country) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">awards =</span> <span class="fu">n</span>(),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">spend_total =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">domestic_spend =</span> <span class="fu">sum</span>(spend_usd[domestic_award], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">domestic_share =</span> domestic_spend <span class="sc">/</span> spend_total,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">cross_border_share =</span> <span class="dv">1</span> <span class="sc">-</span> domestic_share,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(spend_total))</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>dom_country</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 55 × 6
   project_country awards spend_total domestic_spend domestic_share
   &lt;chr&gt;            &lt;int&gt;       &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;
 1 Multi-Countries   4020 3335305123.      10813456.        0.00324
 2 Nigeria            943  955778671.     693274310.        0.725  
 3 Tanzania           205  779355211.     245642744.        0.315  
 4 Senegal           1064  754658146.     593480873.        0.786  
 5 Tunisia            999  670418018.     425291169.        0.634  
 6 Côte D'Ivoire      869  665508222.     276313787.        0.415  
 7 Angola             321  632644505.     141755024.        0.224  
 8 Cameroon           234  584535004.     305016177.        0.522  
 9 Dem Rep Congo      599  564392905.     269384458.        0.477  
10 Kenya              674  536039734.     217900501.        0.407  
# ℹ 45 more rows
# ℹ 1 more variable: cross_border_share &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="domestic-vs-cross-border-sourcing-country-view" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="domestic-vs-cross-border-sourcing-country-view"><span class="header-section-number">1.4</span> Domestic vs cross-border sourcing (country view)</h3>
<ul>
<li>Domestic sourcing is defined as <strong>Bidder Nationality = Project Country</strong>, which provides a clear and explainable proxy for local content.</li>
<li>Countries vary widely: higher domestic shares typically indicate deeper local supplier markets, while low domestic shares reflect reliance on cross-border or international firms.</li>
</ul>
<p>3B) Sector view: domestic share by expense category</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>dom_sector <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(expense_category) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">awards =</span> <span class="fu">n</span>(),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">spend_total =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">domestic_share =</span> <span class="fu">sum</span>(spend_usd[domestic_award], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(spend_usd),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cross_border_share =</span> <span class="dv">1</span> <span class="sc">-</span> domestic_share,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(spend_total))</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>dom_sector</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 5
  expense_category awards  spend_total domestic_share cross_border_share
  &lt;chr&gt;             &lt;int&gt;        &lt;dbl&gt;          &lt;dbl&gt;              &lt;dbl&gt;
1 WORKS              4706 10849633148.          0.360              0.640
2 GOODS              5037  2088588990.          0.398              0.602
3 SERVICES           7950  1615952183.          0.385              0.615
4 MISCELLANEOUS        91   116019924.          0.898              0.102
5 OPERATING COST      275     8151750.          0.603              0.397
6 PERSONNEL            60      441158.          1                  0    
7 UNALLOCATED           2       61989.          1                  0    </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dom_sector, <span class="fu">aes</span>(<span class="at">x =</span> expense_category, <span class="at">y =</span> domestic_share)) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Domestic Share of Spend by Expense Category"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Expense category"</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Domestic share (%)"</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AfDB_Awarded_Contracts_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="domestic-sourcing-by-expense-category" class="level3" data-number="1.5">
<h3 data-number="1.5" class="anchored" data-anchor-id="domestic-sourcing-by-expense-category"><span class="header-section-number">1.5</span> Domestic sourcing by expense category</h3>
<ul>
<li>Domestic sourcing differs structurally by category: <strong>Works</strong> often show higher domestic participation, while <strong>Goods</strong> and <strong>Services</strong> tend to be more cross-border.</li>
<li>These patterns are consistent with differences in capital intensity, technology requirements, and local market depth.</li>
</ul>
<p>3C) Trend over time: is cross-border rising in 2025?</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>dom_trend <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">spend_total =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cross_border_share =</span> <span class="fu">sum</span>(spend_usd[<span class="sc">!</span>domestic_award], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(spend_usd),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>dom_trend</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
   year spend_total cross_border_share
  &lt;int&gt;       &lt;dbl&gt;              &lt;dbl&gt;
1  2020 2805260410.              0.670
2  2021 2695625376.              0.705
3  2022 2130235678.              0.633
4  2023 2988455939.              0.663
5  2024 2788084037.              0.511
6  2025 1271187702.              0.527</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dom_trend, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> cross_border_share)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cross-border Share of Spend by Year"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Cross-border share (%)"</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AfDB_Awarded_Contracts_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cross-border-sourcing-trend" class="level3" data-number="1.6">
<h3 data-number="1.6" class="anchored" data-anchor-id="cross-border-sourcing-trend"><span class="header-section-number">1.6</span> Cross-border sourcing trend</h3>
<ul>
<li>The year-by-year trend shows whether cross-border sourcing has increased in 2025 relative to earlier years.</li>
<li>A rising cross-border share can reflect either expanded competition and regional integration or limited domestic supplier capacity in high-value sectors.</li>
</ul>
<ol start="4" type="1">
<li>Supplier concentration &amp; diversification</li>
</ol>
<p>4A) Defining HHI</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>hhi_calc <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> x <span class="sc">/</span> <span class="fu">sum</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(s<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>HHI interpretation bands (standard, explainable):</p>
<p>Less than 0.10 → unconcentrated / competitive</p>
<p>0.10–0.18 → moderately concentrated</p>
<p>Greater than 0.18 → highly concentrated</p>
<p>4B) Concentration by Project Country</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>conc_country <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_country, bidder_name) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">spend =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_country) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">spend_total =</span> <span class="fu">sum</span>(spend),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppliers =</span> <span class="fu">n</span>(),</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">hhi =</span> <span class="fu">hhi_calc</span>(spend),</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">top1_share =</span> <span class="fu">max</span>(spend) <span class="sc">/</span> <span class="fu">sum</span>(spend),</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">top5_share =</span> <span class="fu">sum</span>(<span class="fu">sort</span>(spend, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">5</span>, <span class="fu">n</span>())]) <span class="sc">/</span> <span class="fu">sum</span>(spend),</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(hhi))</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>conc_country</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 55 × 6
   project_country spend_total suppliers   hhi top1_share top5_share
   &lt;chr&gt;                 &lt;dbl&gt;     &lt;int&gt; &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1 Mauritius         69478437.         8 0.978      0.989      1.000
 2 Egypt            105872155.        59 0.784      0.882      0.985
 3 Libya               335276.         4 0.483      0.641      1    
 4 Eswatini         205048671.        36 0.406      0.615      0.914
 5 Cape Verde        15331001.        29 0.316      0.511      0.852
 6 South Africa     181591049.        16 0.310      0.471      0.985
 7 South Sudan       29332988.        67 0.286      0.522      0.716
 8 Liberia           49147777.       112 0.267      0.506      0.670
 9 Seychelles         2218765.        12 0.266      0.479      0.823
10 Eritrea           70382113.        50 0.254      0.485      0.709
# ℹ 45 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(conc_country, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(project_country, hhi), <span class="at">y =</span> hhi)) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.18</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">number_format</span>(<span class="at">accuracy =</span> <span class="fl">0.01</span>)) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Supplier Concentration by Project Country (HHI)"</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Project country"</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"HHI"</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AfDB_Awarded_Contracts_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="supplier-concentration-by-country" class="level3" data-number="1.7">
<h3 data-number="1.7" class="anchored" data-anchor-id="supplier-concentration-by-country"><span class="header-section-number">1.7</span> Supplier concentration by country</h3>
<ul>
<li>Supplier concentration varies widely across countries, as measured by the <strong>Herfindahl–Hirschman Index (HHI)</strong>.</li>
<li>Countries with <strong>high HHI or very large Top-1 / Top-5 shares</strong> indicate thin supplier markets or repeated reliance on a small number of firms.</li>
<li>High concentration is not automatically problematic, but it raises <strong>market health and probity-relevant questions</strong> in high-value portfolios.</li>
</ul>
<p>4C) Concentration by Sector</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>conc_sector <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sector, bidder_name) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">spend =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sector) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">spend_total =</span> <span class="fu">sum</span>(spend),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppliers =</span> <span class="fu">n</span>(),</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">hhi =</span> <span class="fu">hhi_calc</span>(spend),</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">top1_share =</span> <span class="fu">max</span>(spend) <span class="sc">/</span> <span class="fu">sum</span>(spend),</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">top5_share =</span> <span class="fu">sum</span>(<span class="fu">sort</span>(spend, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">5</span>, <span class="fu">n</span>())]) <span class="sc">/</span> <span class="fu">sum</span>(spend),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(hhi))</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>conc_sector</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 6
   sector          spend_total suppliers     hhi top1_share top5_share
   &lt;chr&gt;                 &lt;dbl&gt;     &lt;int&gt;   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1 Urban Developm.    4684561.        16 0.276       0.464      0.888 
 2 Ind/Mini/Quar      2811453.        41 0.0847      0.186      0.557 
 3 Communications   198179447.       205 0.0765      0.176      0.561 
 4 Finance           36373492.       179 0.0310      0.0882     0.325 
 5 Water Sup/Sanit 1986135834.      1601 0.0151      0.0596     0.216 
 6 Power           3238270836.       772 0.0143      0.0514     0.176 
 7 Transport       5553161824.      1073 0.0132      0.0452     0.167 
 8 Agriculture     2383172063.      4263 0.00640     0.0529     0.125 
 9 Social           735399047.      1894 0.00633     0.0494     0.117 
10 Environment      150032648.       886 0.00603     0.0329     0.108 
11 Multi-Sector     390627940.      1737 0.00487     0.0244     0.0963</code></pre>
</div>
</div>
</section>
<section id="supplier-concentration-by-sector" class="level3" data-number="1.8">
<h3 data-number="1.8" class="anchored" data-anchor-id="supplier-concentration-by-sector"><span class="header-section-number">1.8</span> Supplier concentration by sector</h3>
<ul>
<li>Some sectors exhibit structurally higher concentration, reflecting specialization, capital intensity, or limited qualified suppliers.</li>
<li>Sectors with <strong>high spend and high concentration</strong> are priority candidates for deeper value-for-money and competition analysis.</li>
</ul>
<p>4D) Watchlists</p>
<p>Countries where Top-1 ≥ 50% or Top-5 ≥ 80%</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>country_watchlist <span class="ot">&lt;-</span> conc_country <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(top1_share <span class="sc">&gt;=</span> <span class="fl">0.50</span> <span class="sc">|</span> top5_share <span class="sc">&gt;=</span> <span class="fl">0.80</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>country_watchlist</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 6
   project_country spend_total suppliers   hhi top1_share top5_share
   &lt;chr&gt;                 &lt;dbl&gt;     &lt;int&gt; &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1 Mauritius         69478437.         8 0.978      0.989      1.000
 2 Egypt            105872155.        59 0.784      0.882      0.985
 3 Libya               335276.         4 0.483      0.641      1    
 4 Eswatini         205048671.        36 0.406      0.615      0.914
 5 Cape Verde        15331001.        29 0.316      0.511      0.852
 6 South Africa     181591049.        16 0.310      0.471      0.985
 7 South Sudan       29332988.        67 0.286      0.522      0.716
 8 Liberia           49147777.       112 0.267      0.506      0.670
 9 Seychelles         2218765.        12 0.266      0.479      0.823
10 Algeria             799213.         9 0.244      0.343      0.952
11 Botswana           2168846.         8 0.238      0.414      0.877</code></pre>
</div>
</div>
<p>Sectors with high dominance</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>sector_watchlist <span class="ot">&lt;-</span> conc_sector <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(top1_share <span class="sc">&gt;=</span> <span class="fl">0.50</span> <span class="sc">|</span> top5_share <span class="sc">&gt;=</span> <span class="fl">0.80</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>sector_watchlist</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  sector          spend_total suppliers   hhi top1_share top5_share
  &lt;chr&gt;                 &lt;dbl&gt;     &lt;int&gt; &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
1 Urban Developm.    4684561.        16 0.276      0.464      0.888</code></pre>
</div>
</div>
</section>
<section id="concentration-watchlist" class="level3" data-number="1.9">
<h3 data-number="1.9" class="anchored" data-anchor-id="concentration-watchlist"><span class="header-section-number">1.9</span> Concentration watchlist</h3>
<ul>
<li>The watchlists identify <strong>countries and sectors where spend is dominated by very few suppliers</strong>.</li>
<li>These cases warrant closer examination of market structure, entry barriers, framework arrangements, or repeated award dynamics.</li>
</ul>
<ol start="5" type="1">
<li>Repeat-award &amp; “incumbency” patterns</li>
</ol>
<p>5A) Top repeat winners by Country × Sector (# awards + total USD + years active)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>repeat_cs <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_country, sector, bidder_name) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">awards =</span> <span class="fu">n</span>(),</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">spend_usd =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">years_active =</span> <span class="fu">n_distinct</span>(year),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(awards), <span class="fu">desc</span>(spend_usd))</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Top 10 repeat winners within each country (by award count)</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>top_repeat_by_country <span class="ot">&lt;-</span> repeat_cs <span class="sc">%&gt;%</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_country) <span class="sc">%&gt;%</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> awards, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Top 10 repeat winners within each sector (by award count)</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>top_repeat_by_sector <span class="ot">&lt;-</span> repeat_cs <span class="sc">%&gt;%</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sector) <span class="sc">%&gt;%</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> awards, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>top_repeat_by_country</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 539 × 6
   project_country sector       bidder_name        awards spend_usd years_active
   &lt;chr&gt;           &lt;chr&gt;        &lt;chr&gt;               &lt;int&gt;     &lt;dbl&gt;        &lt;int&gt;
 1 Algeria         Multi-Sector Sociéte AVISYS Te…      2    16936.            1
 2 Algeria         Multi-Sector Ernst andoung Adv…      1   274122.            1
 3 Algeria         Multi-Sector CH Business Consu…      1   201670.            1
 4 Algeria         Multi-Sector Frankfurt School …      1   179201.            1
 5 Algeria         Multi-Sector Samy MOULEY             1    82429.            1
 6 Algeria         Multi-Sector Mohamed Skander         1    23367.            1
 7 Algeria         Multi-Sector Fredj Kchaou            1    16428.            1
 8 Algeria         Multi-Sector MEHIRECHE Moussa        1     4497.            1
 9 Algeria         Agriculture  Mansour EL Hadi         1      564.            1
10 Angola          Agriculture  AFRISEED – STEWAR…     12  2074376.            3
# ℹ 529 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>top_repeat_by_sector</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 110 × 6
   project_country sector      bidder_name         awards spend_usd years_active
   &lt;chr&gt;           &lt;chr&gt;       &lt;chr&gt;                &lt;int&gt;     &lt;dbl&gt;        &lt;int&gt;
 1 Tunisia         Agriculture SOCOOPEC                24  2106465.            5
 2 Kenya           Agriculture M/S OCTAGON BUILDE…     22  5633283.            4
 3 Tunisia         Agriculture Société A2S             18   996920.            3
 4 Burkina Faso    Agriculture DIRECTION REGIONAL…     17  1080264.            2
 5 Nigeria         Agriculture AL-YUMA VENTURES &amp;…     13  6967839.            2
 6 Senegal         Agriculture GROUPEMENT FOLAND/…     12 10879430.            3
 7 Angola          Agriculture AFRISEED – STEWARD…     12  2074376.            3
 8 Kenya           Agriculture Export Hydro Pump …     12   965516.            2
 9 Senegal         Agriculture KELIMANE ENTREPRISE     11 12560414.            4
10 Multi-Countries Agriculture Export Hydro Pump …     11   894609.            2
# ℹ 100 more rows</code></pre>
</div>
</div>
</section>
<section id="repeat-award-patterns-countrysector" class="level3" data-number="1.10">
<h3 data-number="1.10" class="anchored" data-anchor-id="repeat-award-patterns-countrysector"><span class="header-section-number">1.10</span> Repeat-award patterns (country/sector)</h3>
<ul>
<li>Repeat awarding is visible when a small set of suppliers accumulate many contracts within the same country and sector.</li>
<li>This is not inherently negative (e.g., frameworks, long programs, specialized expertise), but it is a <strong>probity-relevant</strong> signal and a high-value starting point for targeted review.</li>
</ul>
<p>5B) Repeat winners by Project (incumbency within a project/loan)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>repeat_project <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_def, loan_number, bidder_name) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">awards =</span> <span class="fu">n</span>(),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">spend_usd =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">years_active =</span> <span class="fu">n_distinct</span>(year),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(awards), <span class="fu">desc</span>(spend_usd))</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>repeat_project <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">100</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 6
   project_def  loan_number   bidder_name          awards spend_usd years_active
   &lt;chr&gt;        &lt;chr&gt;         &lt;chr&gt;                 &lt;int&gt;     &lt;dbl&gt;        &lt;int&gt;
 1 P-TN-E00-006 2000200000402 SOCOOPEC                 43  2272815.            5
 2 P-ET-DB0-018 2100155026168 Ethiopian Managemen…     17   517405.            1
 3 P-CI-KF0-001 2100155030620 AFAQ AFNOR               16    91808.            2
 4 P-KE-AAZ-009 5570155000751 M/S OCTAGON BUILDER…     15  1773212.            3
 5 P-TN-E00-006 2000200000402 STEG SOCIETE TUN DE…     14   270591.            3
 6 P-NG-AAB-003 2100150029994 AL-YUMA VENTURES &amp; …     13  6967839.            2
 7 P-BF-AA0-037 5900150003504 DIRECTION REGIONALE…     13   690527.            1
 8 P-AO-AAZ-001 2000200002052 AFRISEED – STEWARDS…     12  2074376.            3
 9 P-CI-KF0-001 2100155030620 Bureau Veritas Côte…     12    85259.            2
10 P-NG-E00-007 2000130011585 CGC NIGERIA LTD          11 82809941.            2
# ℹ 90 more rows</code></pre>
</div>
</div>
<p>Flag “single supplier dominates a project” (spend share ≥ 80%)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>proj_dom <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_def, loan_number, bidder_name) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">spend =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_def, loan_number) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">share =</span> spend <span class="sc">/</span> <span class="fu">sum</span>(spend)) <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(share <span class="sc">&gt;=</span> <span class="fl">0.80</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(share), <span class="fu">desc</span>(spend))</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>proj_dom <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">200</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 200 × 5
   project_def  loan_number   bidder_name                            spend share
   &lt;chr&gt;        &lt;chr&gt;         &lt;chr&gt;                                  &lt;dbl&gt; &lt;dbl&gt;
 1 P-Z1-FA0-164 2100155040366 Consortium of Siemens Energy Global … 1.67e8     1
 2 P-SZ-A00-005 2000200005202 SAKHALIVE JV                          1.26e8     1
 3 P-ZA-EA0-004 2000200005058 Kopano Ke Matla Joint Venture         8.55e7     1
 4 P-MU-FA0-004 2000300000452 CHINA MACHINERY ENGINEERING CORPORAT… 6.87e7     1
 5 P-MA-DD0-008 2000200005508 Groupement STFA SGTM Jan de Nul       6.17e7     1
 6 P-Z1-DB0-182 6550655001101 SINTRAM                               4.73e7     1
 7 P-UG-DB0-016 2100150042245 CHINA RAILWAY 18TH BUREAU (GROUP) Co… 3.80e7     1
 8 P-MW-AA0-024 2100150040548 Sinohydro Corporation Ltd             2.85e7     1
 9 P-Z1-DB0-039 5110155000758 China Railway International Group     2.55e7     1
10 P-CM-DB0-012 6550655001001 Sinohydro Corporation Ltd             2.54e7     1
# ℹ 190 more rows</code></pre>
</div>
</div>
</section>
<section id="project-level-incumbency-dominance" class="level3" data-number="1.11">
<h3 data-number="1.11" class="anchored" data-anchor-id="project-level-incumbency-dominance"><span class="header-section-number">1.11</span> Project-level incumbency / dominance</h3>
<ul>
<li>Project-level repeat awarding highlights cases where suppliers repeatedly win within a single project/loan.</li>
<li>Projects where one supplier captures an extreme share of spend should be treated as <strong>screening flags</strong> for closer governance review (competition history, justification, and contract management).</li>
</ul>
<p>5C) Supplier “footprint” summary (# countries served, # sectors, total awards, total USD)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>supplier_footprint <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bidder_name) <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">awards =</span> <span class="fu">n</span>(),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">spend_usd =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">countries_served =</span> <span class="fu">n_distinct</span>(project_country),</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sectors_served =</span> <span class="fu">n_distinct</span>(sector),</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">years_active =</span> <span class="fu">n_distinct</span>(year),</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(spend_usd))</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>supplier_footprint <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">50</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 6
   bidder_name     awards spend_usd countries_served sectors_served years_active
   &lt;chr&gt;            &lt;int&gt;     &lt;dbl&gt;            &lt;int&gt;          &lt;int&gt;        &lt;int&gt;
 1 SINOHYDRO CORP…     18    2.95e8                9              3            6
 2 Jiangxi Transp…      9    2.51e8                2              1            3
 3 CHINA RAILWAY …      7    1.97e8                3              2            3
 4 Consortium of …      1    1.67e8                1              1            1
 5 CHINA WU YI CO…      7    1.66e8                3              1            2
 6 China Henan In…      5    1.60e8                3              2            2
 7 Sinohydro Corp…     10    1.39e8                4              4            4
 8 M/S BEIJING CO…      3    1.36e8                1              1            2
 9 SAKHALIVE JV         1    1.26e8                1              1            1
10 CGC NIGERIA LTD     16    1.22e8                2              3            3
# ℹ 40 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>supplier_profile <span class="ot">&lt;-</span> supplier_footprint <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">footprint_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>      countries_served <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> sectors_served <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Single-country, single-sector"</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>      countries_served <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> sectors_served <span class="sc">&gt;</span> <span class="dv">1</span>  <span class="sc">~</span> <span class="st">"Single-country, multi-sector"</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>      countries_served <span class="sc">&gt;</span> <span class="dv">1</span>  <span class="sc">&amp;</span> sectors_served <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Multi-country, single-sector"</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span>                                        <span class="sc">~</span> <span class="st">"Multi-country, multi-sector"</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>supplier_profile <span class="sc">%&gt;%</span> <span class="fu">count</span>(footprint_type, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  footprint_type                    n
  &lt;chr&gt;                         &lt;int&gt;
1 Single-country, single-sector 10730
2 Multi-country, multi-sector     447
3 Single-country, multi-sector    343
4 Multi-country, single-sector    162</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>supplier_profile <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">50</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 7
   bidder_name     awards spend_usd countries_served sectors_served years_active
   &lt;chr&gt;            &lt;int&gt;     &lt;dbl&gt;            &lt;int&gt;          &lt;int&gt;        &lt;int&gt;
 1 SINOHYDRO CORP…     18    2.95e8                9              3            6
 2 Jiangxi Transp…      9    2.51e8                2              1            3
 3 CHINA RAILWAY …      7    1.97e8                3              2            3
 4 Consortium of …      1    1.67e8                1              1            1
 5 CHINA WU YI CO…      7    1.66e8                3              1            2
 6 China Henan In…      5    1.60e8                3              2            2
 7 Sinohydro Corp…     10    1.39e8                4              4            4
 8 M/S BEIJING CO…      3    1.36e8                1              1            2
 9 SAKHALIVE JV         1    1.26e8                1              1            1
10 CGC NIGERIA LTD     16    1.22e8                2              3            3
# ℹ 40 more rows
# ℹ 1 more variable: footprint_type &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="supplier-footprint-breadth-vs-dependence" class="level3" data-number="1.12">
<h3 data-number="1.12" class="anchored" data-anchor-id="supplier-footprint-breadth-vs-dependence"><span class="header-section-number">1.12</span> Supplier footprint (breadth vs dependence)</h3>
<ul>
<li>The supplier footprint view distinguishes between suppliers that are <strong>broadly active</strong> (multi-country and/or multi-sector) and those that are <strong>highly concentrated</strong> (single-country/sector dependence).</li>
<li>High spend with a narrow footprint can indicate specialization or market thinness; it is also where <strong>incumbency risk</strong> is most relevant.</li>
</ul>
<ol start="6" type="1">
<li>Contract fragmentation / “threshold clustering”</li>
</ol>
<p>6A) Project/Loan fragmentation table</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>frag_proj <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_def, loan_number) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">awards =</span> <span class="fu">n</span>(),</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">spend_total =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_usd =</span> <span class="fu">median</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_below_50k  =</span> <span class="fu">mean</span>(spend_usd <span class="sc">&lt;</span>  <span class="dv">50000</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_below_100k =</span> <span class="fu">mean</span>(spend_usd <span class="sc">&lt;</span> <span class="dv">100000</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_below_250k =</span> <span class="fu">mean</span>(spend_usd <span class="sc">&lt;</span> <span class="dv">250000</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(awards), <span class="fu">desc</span>(spend_total))</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>frag_proj <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">100</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 8
   project_def  loan_number   awards spend_total median_usd p_below_50k
   &lt;chr&gt;        &lt;chr&gt;          &lt;int&gt;       &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
 1 P-TN-E00-006 2000200000402    300   74435080.     92265.      0.323 
 2 P-NG-I00-001 2000200000701    277   99882332.    269261.      0.184 
 3 P-KE-AAZ-009 5570155000751    239   23378570.     64342.      0.406 
 4 P-SN-KE0-004 2100150039645    201   10523702.     26372.      0.786 
 5 P-NG-I00-001 2100150036593    198   66144166.    158351.      0.273 
 6 P-Z1-AAZ-011 2100150028345    189   26153405.     59069.      0.360 
 7 P-Z1-C00-081 2100150042746    165   12885811.     84656.      0.188 
 8 P-CI-KF0-001 2100155030620    148    3635895.     19365.      0.926 
 9 P-AO-AAZ-001 2000200002052    145   92507204.    161909.      0.131 
10 P-GH-EA0-008 2100150037195    132   30109956.     70742.      0.0530
# ℹ 90 more rows
# ℹ 2 more variables: p_below_100k &lt;dbl&gt;, p_below_250k &lt;dbl&gt;</code></pre>
</div>
</div>
<p>“Fragmentation watchlist” (many awards + lots of micro-contracts)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>frag_watchlist <span class="ot">&lt;-</span> frag_proj <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(awards <span class="sc">&gt;=</span> <span class="dv">30</span> <span class="sc">&amp;</span> (p_below_50k <span class="sc">&gt;=</span> <span class="fl">0.50</span> <span class="sc">|</span> p_below_100k <span class="sc">&gt;=</span> <span class="fl">0.70</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(awards))</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>frag_watchlist</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 62 × 8
   project_def  loan_number   awards spend_total median_usd p_below_50k
   &lt;chr&gt;        &lt;chr&gt;          &lt;int&gt;       &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
 1 P-SN-KE0-004 2100150039645    201   10523702.     26372.       0.786
 2 P-Z1-C00-081 2100150042746    165   12885811.     84656.       0.188
 3 P-CI-KF0-001 2100155030620    148    3635895.     19365.       0.926
 4 P-ZM-IE0-002 2000130014280    119    6117101.     16118.       0.874
 5 P-TN-AA0-009 2000200004401    108    6549875.     30174.       0.602
 6 P-TN-IA0-004 2000200001953    102   53172843.     40570.       0.549
 7 P-TN-AAB-001 5050200000101    102    8970309.     25771.       0.657
 8 P-KE-AAZ-009 2000130014530     92   16687713.     70254.       0.163
 9 P-SN-I00-008 2100150042248     88    6365073.     38945.       0.693
10 P-TG-IZ0-002 2100155030917     82    3007980.     13402.       0.817
# ℹ 52 more rows
# ℹ 2 more variables: p_below_100k &lt;dbl&gt;, p_below_250k &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="contract-fragmentation-by-projectloan" class="level3" data-number="1.13">
<h3 data-number="1.13" class="anchored" data-anchor-id="contract-fragmentation-by-projectloan"><span class="header-section-number">1.13</span> Contract fragmentation by project/loan</h3>
<ul>
<li>Fragmentation is proxied using the <strong>count of awards per project/loan</strong> and the <strong>share of awards below common micro-procurement thresholds</strong> (USD 50k / 100k / 250k).</li>
<li>Projects with <strong>high award counts</strong> and <strong>high shares of small awards</strong> may indicate packaging/splitting patterns, capacity constraints, or weak procurement planning (screening signal, not proof).</li>
</ul>
<p>6B) “Near-threshold” clustering charts (histograms)</p>
<p>6B(i) Global histogram (linear)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> spend_usd)) <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">120</span>) <span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>()) <span class="sc">+</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Award Size Histogram (linear scale)"</span>,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Award size (USD)"</span>,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count of awards"</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AfDB_Awarded_Contracts_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>6B(ii) Global histogram (log)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> spend_usd)) <span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">120</span>) <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>()) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Award Size Histogram (log scale)"</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Award size (USD, log scale)"</span>,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count of awards"</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AfDB_Awarded_Contracts_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Adding reference lines at common thresholds</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> spend_usd)) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">120</span>) <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">50000</span>, <span class="dv">100000</span>, <span class="dv">250000</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>()) <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Award Size Histogram with Threshold Markers"</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Award size (USD)"</span>,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count of awards"</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AfDB_Awarded_Contracts_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="near-threshold-clustering-spike-detection" class="level3" data-number="1.14">
<h3 data-number="1.14" class="anchored" data-anchor-id="near-threshold-clustering-spike-detection"><span class="header-section-number">1.14</span> Near-threshold clustering (spike detection)</h3>
<ul>
<li>Histograms help detect <strong>spikes</strong> at or just below common thresholds, which can be consistent with threshold-driven packaging behavior.</li>
<li>Visible “heaping” near thresholds should be treated as a <strong>screening indicator</strong> and paired with follow-up questions (e.g., procurement plan rationale, lots, and approvals).</li>
</ul>
<p>6C) “Heaping Score” near thresholds: This quantifies whether values cluster within a narrow band just below thresholds.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>band_share <span class="ot">&lt;-</span> <span class="cf">function</span>(thresh, <span class="at">width =</span> <span class="fl">0.05</span>){</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  lo <span class="ot">&lt;-</span> thresh <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> width)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  hi <span class="ot">&lt;-</span> thresh</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(df<span class="sc">$</span>spend_usd <span class="sc">&gt;=</span> lo <span class="sc">&amp;</span> df<span class="sc">$</span>spend_usd <span class="sc">&lt;</span> hi, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>heaping <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">threshold =</span> <span class="fu">c</span>(<span class="dv">50000</span>, <span class="dv">100000</span>, <span class="dv">250000</span>),</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">share_in_last_5pct =</span> <span class="fu">c</span>(<span class="fu">band_share</span>(<span class="dv">50000</span>), <span class="fu">band_share</span>(<span class="dv">100000</span>), <span class="fu">band_share</span>(<span class="dv">250000</span>))</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>heaping</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  threshold share_in_last_5pct
      &lt;dbl&gt;              &lt;dbl&gt;
1     50000            0.0129 
2    100000            0.0114 
3    250000            0.00894</code></pre>
</div>
</div>
</section>
<section id="heaping-metric-quantitative-check" class="level3" data-number="1.15">
<h3 data-number="1.15" class="anchored" data-anchor-id="heaping-metric-quantitative-check"><span class="header-section-number">1.15</span> Heaping metric (quantitative check)</h3>
<ul>
<li>The “heaping share” measures what fraction of awards fall in the <strong>last 5% band below each threshold</strong>.</li>
<li>Elevated heaping shares strengthen the case that observed spikes are not random noise and warrant targeted review.</li>
</ul>
<ol start="7" type="1">
<li>Project procurement intensity &amp; implementation proxy</li>
</ol>
<p>7A) Project-level procurement intensity table</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>proj_intensity <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_def) <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">awards =</span> <span class="fu">n</span>(),</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">spend_total =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_award =</span> <span class="fu">mean</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppliers =</span> <span class="fu">n_distinct</span>(bidder_name),</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">methods =</span> <span class="fu">n_distinct</span>(proc_mode),</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(awards))</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>proj_intensity <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">50</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 6
   project_def  awards spend_total avg_award suppliers methods
   &lt;chr&gt;         &lt;int&gt;       &lt;dbl&gt;     &lt;dbl&gt;     &lt;int&gt;   &lt;int&gt;
 1 P-NG-I00-001    486  167029965.   343683.       388       4
 2 P-KE-AAZ-009    331   40066283.   121046.       223       2
 3 P-TN-E00-006    325   75386678.   231959.       162       3
 4 P-SN-A00-013    242  119667274.   494493.        94       3
 5 P-SN-KE0-004    220   30220587.   137366.       128       5
 6 P-TN-AAB-001    205   32999045.   160971.        67       2
 7 P-Z1-AAZ-011    189   26153405.   138378.       100       2
 8 P-Z1-C00-081    165   12885811.    78096.       130       2
 9 P-ML-I00-006    159    4030081.    25346.        45       3
10 P-CI-KF0-001    148    3635895.    24567.        47       6
# ℹ 40 more rows</code></pre>
</div>
</div>
<p>Looking at largest products by spend</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>proj_intensity <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(spend_total)) <span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">50</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 6
   project_def  awards spend_total avg_award suppliers methods
   &lt;chr&gt;         &lt;int&gt;       &lt;dbl&gt;     &lt;dbl&gt;     &lt;int&gt;   &lt;int&gt;
 1 P-AO-FA0-003     24  394551269. 16439636.        16       4
 2 P-CI-D00-010     44  281338022.  6394046.        38       5
 3 P-MA-FA0-008     69  256180886.  3712766.        23       4
 4 P-TZ-DA0-003      7  232367551. 33195364.         4       1
 5 P-NG-FA0-011     12  230151411. 19179284.         5       1
 6 P-KE-DB0-037     28  221544572.  7912306.        22       3
 7 P-UG-DB0-016     22  196136462.  8915294.        20       2
 8 P-Z1-DB0-204     43  184577299.  4292495.        32       2
 9 P-Z1-DB0-129     24  170377644.  7099068.        15       2
10 P-Z1-D00-047     15  167398782. 11159919.        14       5
# ℹ 40 more rows</code></pre>
</div>
</div>
</section>
<section id="project-procurement-intensity" class="level3" data-number="1.16">
<h3 data-number="1.16" class="anchored" data-anchor-id="project-procurement-intensity"><span class="header-section-number">1.16</span> Project procurement intensity</h3>
<ul>
<li>Projects differ significantly in how procurement activity is structured, ranging from a few large awards to many small contracts.</li>
<li>Projects with <strong>very high award counts</strong>, many suppliers, and multiple procurement methods often indicate <strong>implementation complexity</strong> or capacity constraints.</li>
</ul>
<p>7B) “Complexity index”</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>proj_complexity <span class="ot">&lt;-</span> proj_intensity <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">complexity_index =</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale</span>(awards)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale</span>(suppliers)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale</span>(methods)[,<span class="dv">1</span>]</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(complexity_index))</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>proj_complexity <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">50</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 7
   project_def  awards spend_total avg_award suppliers methods complexity_index
   &lt;chr&gt;         &lt;int&gt;       &lt;dbl&gt;     &lt;dbl&gt;     &lt;int&gt;   &lt;int&gt;            &lt;dbl&gt;
 1 P-NG-I00-001    486  167029965.   343683.       388       4            33.6 
 2 P-KE-AAZ-009    331   40066283.   121046.       223       2            19.5 
 3 P-TN-E00-006    325   75386678.   231959.       162       3            17.2 
 4 P-SN-KE0-004    220   30220587.   137366.       128       5            13.7 
 5 P-SN-A00-013    242  119667274.   494493.        94       3            11.3 
 6 P-CI-AA0-020    136   60614225.   445693.       103       6            10.6 
 7 P-AO-AAZ-001    145   92507204.   637981.        89       6            10.3 
 8 P-Z1-C00-081    165   12885811.    78096.       130       2             9.84
 9 P-GH-EA0-008    132   30109956.   228106.       104       5             9.80
10 P-SN-KA0-015    108   10964917.   101527.        84       7             9.59
# ℹ 40 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(proj_complexity, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(project_def, complexity_index),</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> complexity_index)) <span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Project Procurement Complexity Index"</span>,</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Project"</span>,</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Composite complexity score"</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AfDB_Awarded_Contracts_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="project-complexity-index" class="level3" data-number="1.17">
<h3 data-number="1.17" class="anchored" data-anchor-id="project-complexity-index"><span class="header-section-number">1.17</span> Project complexity index</h3>
<ul>
<li>The complexity index combines <strong>award volume</strong>, <strong>supplier diversity</strong>, and <strong>method diversity</strong> into a single screening metric.</li>
<li>High scores flag projects that may require stronger procurement planning, contract management capacity, or supervision.</li>
</ul>
<p>7C) Micro-contract intensity</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>proj_micro <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_def) <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">awards =</span> <span class="fu">n</span>(),</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_below_100k =</span> <span class="fu">mean</span>(spend_usd <span class="sc">&lt;</span> <span class="dv">100000</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_below_50k  =</span> <span class="fu">mean</span>(spend_usd <span class="sc">&lt;</span> <span class="dv">50000</span>,  <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(p_below_50k))</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>proj_micro <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">50</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 4
   project_def  awards p_below_100k p_below_50k
   &lt;chr&gt;         &lt;int&gt;        &lt;dbl&gt;       &lt;dbl&gt;
 1 P-AO-HZ0-001      6            1           1
 2 P-AO-KF0-005      1            1           1
 3 P-BF-AAD-006      9            1           1
 4 P-BF-DB0-017      2            1           1
 5 P-BF-E00-021      1            1           1
 6 P-BF-HAA-001      1            1           1
 7 P-BJ-IAE-004     18            1           1
 8 P-CF-IE0-004      2            1           1
 9 P-CI-AA0-024      1            1           1
10 P-CI-EB0-001      1            1           1
# ℹ 40 more rows</code></pre>
</div>
</div>
</section>
<section id="micro-contract-intensity" class="level3" data-number="1.18">
<h3 data-number="1.18" class="anchored" data-anchor-id="micro-contract-intensity"><span class="header-section-number">1.18</span> Micro-contract intensity</h3>
<ul>
<li>A high share of micro-contracts within a project can signal <strong>transactional overload</strong>, weak packaging, or design issues.</li>
<li>These projects are strong candidates for deeper implementation review.</li>
</ul>
<ol start="8" type="1">
<li>Country procurement profile “fingerprints” (Country Cards)</li>
</ol>
<p>8A) Helper functions</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>hhi_calc <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> x <span class="sc">/</span> <span class="fu">sum</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(s<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>country_card_tables <span class="ot">&lt;-</span> <span class="cf">function</span>(cty, <span class="at">top_n =</span> <span class="dv">10</span>){</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(project_country <span class="sc">==</span> cty)</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  headline <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">awards =</span> <span class="fu">n</span>(),</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">spend_total =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">domestic_share =</span> <span class="fu">sum</span>(spend_usd[domestic_award], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>  trend <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">awards =</span> <span class="fu">n</span>(),</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">spend_total =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">cross_border_share =</span> <span class="fu">sum</span>(spend_usd[<span class="sc">!</span>domestic_award], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(year)</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>  top_sectors <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(sector) <span class="sc">%&gt;%</span></span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">spend_total =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">awards =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(spend_total)) <span class="sc">%&gt;%</span></span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_head</span>(<span class="at">n =</span> top_n)</span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>  method_mix <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(proc_mode) <span class="sc">%&gt;%</span></span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">spend_total =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">awards =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">share =</span> spend_total <span class="sc">/</span> <span class="fu">sum</span>(spend_total)) <span class="sc">%&gt;%</span></span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(spend_total))</span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a>  suppliers_tbl <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(bidder_name) <span class="sc">%&gt;%</span></span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">spend =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">awards =</span> <span class="fu">n</span>(),</span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(spend))</span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a>  spend_vec <span class="ot">&lt;-</span> suppliers_tbl <span class="sc">%&gt;%</span> <span class="fu">pull</span>(spend)</span>
<span id="cb62-52"><a href="#cb62-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-53"><a href="#cb62-53" aria-hidden="true" tabindex="-1"></a>  concentration <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb62-54"><a href="#cb62-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">suppliers =</span> <span class="fu">nrow</span>(suppliers_tbl),</span>
<span id="cb62-55"><a href="#cb62-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">hhi =</span> <span class="fu">hhi_calc</span>(spend_vec),</span>
<span id="cb62-56"><a href="#cb62-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">top1_share =</span> <span class="fu">max</span>(spend_vec, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(spend_vec, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-57"><a href="#cb62-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">top5_share =</span> <span class="fu">sum</span>(<span class="fu">head</span>(spend_vec, <span class="dv">5</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(spend_vec, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-58"><a href="#cb62-58" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-59"><a href="#cb62-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-60"><a href="#cb62-60" aria-hidden="true" tabindex="-1"></a>  top_suppliers <span class="ot">&lt;-</span> suppliers_tbl <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> top_n)</span>
<span id="cb62-61"><a href="#cb62-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-62"><a href="#cb62-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb62-63"><a href="#cb62-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">country =</span> cty,</span>
<span id="cb62-64"><a href="#cb62-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">headline =</span> headline,</span>
<span id="cb62-65"><a href="#cb62-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">trend =</span> trend,</span>
<span id="cb62-66"><a href="#cb62-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">top_sectors =</span> top_sectors,</span>
<span id="cb62-67"><a href="#cb62-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">method_mix =</span> method_mix,</span>
<span id="cb62-68"><a href="#cb62-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">concentration =</span> concentration,</span>
<span id="cb62-69"><a href="#cb62-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">top_suppliers =</span> top_suppliers</span>
<span id="cb62-70"><a href="#cb62-70" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-71"><a href="#cb62-71" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>8B) Generating a card for one country (Can replace any country for Ghana)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>cty <span class="ot">&lt;-</span> <span class="st">"Ghana"</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>card <span class="ot">&lt;-</span> <span class="fu">country_card_tables</span>(cty)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>card<span class="sc">$</span>headline</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  awards spend_total domestic_share
   &lt;int&gt;       &lt;dbl&gt;          &lt;dbl&gt;
1    389  203443830.          0.837</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>card<span class="sc">$</span>trend</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
   year awards spend_total cross_border_share
  &lt;int&gt;  &lt;int&gt;       &lt;dbl&gt;              &lt;dbl&gt;
1  2020    163   65021401.            0.183  
2  2021     25    6571599.            0.315  
3  2022     84   24375849.            0.0532 
4  2023     41   18642262.            0.0722 
5  2024     41   60526984.            0.00974
6  2025     35   28305736.            0.565  </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>card<span class="sc">$</span>top_sectors</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  sector          spend_total awards
  &lt;chr&gt;                 &lt;dbl&gt;  &lt;int&gt;
1 Agriculture       65757012.    149
2 Transport         60512635.     23
3 Power             35599733.     18
4 Water Sup/Sanit   31016452.    136
5 Multi-Sector       5670457.     48
6 Social             4887540.     15</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>card<span class="sc">$</span>method_mix</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  proc_mode spend_total awards    share
  &lt;chr&gt;           &lt;dbl&gt;  &lt;int&gt;    &lt;dbl&gt;
1 ICB        112126132.     50 0.551   
2 NCB         71598423.    227 0.352   
3 SHL         10777732.     52 0.0530  
4 NSH          5690576.     46 0.0280  
5 DNP          2777177.      9 0.0137  
6 LIC           310633.      3 0.00153 
7 ISH           163156.      2 0.000802</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>card<span class="sc">$</span>concentration</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  suppliers    hhi top1_share top5_share
      &lt;int&gt;  &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
1       276 0.0824      0.261      0.445</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>card<span class="sc">$</span>top_suppliers</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
   bidder_name                                  spend awards
   &lt;chr&gt;                                        &lt;dbl&gt;  &lt;int&gt;
 1 CHINA JIANGXI INTERNATIONAL ECONOMIC AND 53200418.      2
 2 CHINE INTERNATIONAL WATER AND ELECTRIC C 15985639.      2
 3 CHINA INTL WATER ELECTRIC CORP            9541953.      2
 4 MEHAK LIMITED                             6629600.      4
 5 ETC/ETG AGRO-GH LIMITED                   5274250.      5
 6 WILKINS ENGINEERING LIMITED               5071653.      4
 7 Alpha TND Limited &amp; Capital Electech PVT  4023553.      1
 8 DIZENGOFF GHANA                           3475506.      3
 9 Vuluxx Ghana Limited                      3064806.      1
10 UNIVEC COMPLEX VENTURES                   3044805.      3</code></pre>
</div>
</div>
<p>8C) Optional charts for the card</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Spend trend</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(card<span class="sc">$</span>trend, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> spend_total)) <span class="sc">+</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>()) <span class="sc">+</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Spend Trend —"</span>, cty), <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Spend (USD)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AfDB_Awarded_Contracts_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Award count trend</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(card<span class="sc">$</span>trend, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> awards)) <span class="sc">+</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_comma</span>()) <span class="sc">+</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Award Count Trend —"</span>, cty), <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Awards"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AfDB_Awarded_Contracts_files/figure-html/unnamed-chunk-30-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-border share trend</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(card<span class="sc">$</span>trend, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> cross_border_share)) <span class="sc">+</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="sc">+</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Cross-border Share Trend —"</span>, cty), <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Cross-border share"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AfDB_Awarded_Contracts_files/figure-html/unnamed-chunk-30-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>8D) Producing cards for top 10 countries by spend</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>top_countries <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_country) <span class="sc">%&gt;%</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">spend_total =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(spend_total)) <span class="sc">%&gt;%</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(project_country)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>cards <span class="ot">&lt;-</span> <span class="fu">lapply</span>(top_countries, country_card_tables)</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cards) <span class="ot">&lt;-</span> top_countries</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>top_countries</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Multi-Countries" "Nigeria"         "Tanzania"        "Senegal"        
 [5] "Tunisia"         "Côte D'Ivoire"   "Angola"          "Cameroon"       
 [9] "Dem Rep Congo"   "Kenya"          </code></pre>
</div>
</div>
</section>
<section id="country-procurement-fingerprint-ghana" class="level3" data-number="1.19">
<h3 data-number="1.19" class="anchored" data-anchor-id="country-procurement-fingerprint-ghana"><span class="header-section-number">1.19</span> Country procurement fingerprint — Ghana</h3>
<ul>
<li>Total procurement in this country (2020–2025): <strong>389 awards</strong> and <strong>$203,443,830</strong> in spend.</li>
<li>Domestic sourcing share is <strong>84%</strong>, implying a cross-border share of <strong>16%</strong>.</li>
<li>Top sectors and method mix show where procurement activity concentrates and which approaches carry the most value.</li>
<li>Supplier concentration is <strong>HHI = 0.082</strong>, with Top-1 share <strong>26%</strong> and Top-5 share <strong>45%</strong>.</li>
</ul>
<ol start="9" type="1">
<li>Sector deep-dives</li>
</ol>
<p>9A) Identifying priority sectors</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>top_sectors <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sector) <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">spend_total =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">awards =</span> <span class="fu">n</span>(),</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(spend_total))</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>top_sectors</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 3
   sector          spend_total awards
   &lt;chr&gt;                 &lt;dbl&gt;  &lt;int&gt;
 1 Transport       5553161824.   1635
 2 Power           3238270836.   1174
 3 Agriculture     2383172063.   6356
 4 Water Sup/Sanit 1986135834.   2277
 5 Social           735399047.   2616
 6 Multi-Sector     390627940.   2347
 7 Communications   198179447.    253
 8 Environment      150032648.   1186
 9 Finance           36373492.    218
10 Urban Developm.    4684561.     16
11 Ind/Mini/Quar      2811453.     43</code></pre>
</div>
</div>
<p>9B) Method mix by sector (value-weighted)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Choosing priority sectors explicitly</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>priority_sectors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Transport"</span>, <span class="st">"Power"</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>priority_sectors</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Transport" "Power"    </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>sector_method <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sector <span class="sc">%in%</span> priority_sectors) <span class="sc">%&gt;%</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sector, proc_mode) <span class="sc">%&gt;%</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">spend_total =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">awards =</span> <span class="fu">n</span>(),</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sector) <span class="sc">%&gt;%</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">share =</span> spend_total <span class="sc">/</span> <span class="fu">sum</span>(spend_total))</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>sector_method</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 5
# Groups:   sector [2]
   sector    proc_mode spend_total awards      share
   &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;  &lt;int&gt;      &lt;dbl&gt;
 1 Power     DNP         98954779.    125 0.0306    
 2 Power     ICB       2940565763.    646 0.908     
 3 Power     ISH         13385534.     11 0.00413   
 4 Power     LIC            25673.      1 0.00000793
 5 Power     NCB        130611564.    190 0.0403    
 6 Power     NSH          1856673.     21 0.000573  
 7 Power     SHL         52838837.    179 0.0163    
 8 Power     &lt;NA&gt;           32013.      1 0.00000989
 9 Transport DNP        143452726.    176 0.0258    
10 Transport ICB       4344948076.    547 0.782     
11 Transport ISH        586206822.    121 0.106     
12 Transport LIC           159091.      5 0.0000286 
13 Transport NCB        165180404.    203 0.0297    
14 Transport NSH         24432966.     80 0.00440   
15 Transport SHL        288719929.    501 0.0520    
16 Transport &lt;NA&gt;           61810.      2 0.0000111 </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sector_method,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> proc_mode, <span class="at">y =</span> spend_total, <span class="at">fill =</span> proc_mode)) <span class="sc">+</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>()) <span class="sc">+</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> sector, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Procurement Method Mix by Sector"</span>,</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Procurement mode"</span>,</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Spend (USD)"</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AfDB_Awarded_Contracts_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="method-mix-within-priority-sectors" class="level3" data-number="1.20">
<h3 data-number="1.20" class="anchored" data-anchor-id="method-mix-within-priority-sectors"><span class="header-section-number">1.20</span> Method mix within priority sectors</h3>
<ul>
<li>High-value sectors such as Transport and Power show distinct procurement profiles, with a larger share of spend typically flowing through more competitive methods.</li>
<li>Any material use of lower-competition methods in these sectors carries heightened VfM and governance relevance.</li>
</ul>
<p>9C) Supplier nationality mix (domestic vs cross-border)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>sector_nationality <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sector <span class="sc">%in%</span> priority_sectors) <span class="sc">%&gt;%</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sector, domestic_award) <span class="sc">%&gt;%</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">spend_total =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sector) <span class="sc">%&gt;%</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">share =</span> spend_total <span class="sc">/</span> <span class="fu">sum</span>(spend_total))</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>sector_nationality</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
# Groups:   sector [2]
  sector    domestic_award spend_total share
  &lt;chr&gt;     &lt;lgl&gt;                &lt;dbl&gt; &lt;dbl&gt;
1 Power     FALSE          2668060014. 0.824
2 Power     TRUE            570210822. 0.176
3 Transport FALSE          4339233349. 0.781
4 Transport TRUE           1213928476. 0.219</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sector_nationality,</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> domestic_award, <span class="at">y =</span> spend_total, <span class="at">fill =</span> domestic_award)) <span class="sc">+</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>()) <span class="sc">+</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> sector) <span class="sc">+</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"Cross-border"</span>, <span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"Domestic"</span>)) <span class="sc">+</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Domestic vs Cross-border Spend by Sector"</span>,</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Spend (USD)"</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AfDB_Awarded_Contracts_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="supplier-nationality-mix" class="level3" data-number="1.21">
<h3 data-number="1.21" class="anchored" data-anchor-id="supplier-nationality-mix"><span class="header-section-number">1.21</span> Supplier nationality mix</h3>
<ul>
<li>Priority sectors differ in their reliance on domestic versus cross-border suppliers.</li>
<li>Higher cross-border shares often reflect technology intensity and limited local capacity, particularly in capital-intensive sectors.</li>
</ul>
<p>9D) Top suppliers in each sector + cross-country footprint</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>sector_suppliers <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sector <span class="sc">%in%</span> priority_sectors) <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sector, bidder_name) <span class="sc">%&gt;%</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">spend_usd =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">awards =</span> <span class="fu">n</span>(),</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">countries_served =</span> <span class="fu">n_distinct</span>(project_country),</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(sector, <span class="fu">desc</span>(spend_usd))</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>sector_suppliers <span class="sc">%&gt;%</span></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sector) <span class="sc">%&gt;%</span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 5
# Groups:   sector [2]
   sector    bidder_name                       spend_usd awards countries_served
   &lt;chr&gt;     &lt;chr&gt;                                 &lt;dbl&gt;  &lt;int&gt;            &lt;int&gt;
 1 Power     Consortium of Siemens Energy Glo…    1.67e8      1                1
 2 Power     M/S DONGFANG ELECTRIC INTERNATIO…    1.14e8      2                1
 3 Power     JV CRBC - XJ                         1.01e8      2                1
 4 Power     JV of XIAN ELECTRIC ENGINEERING …    9.46e7      2                1
 5 Power     Kalpataru Projects International…    9.32e7      4                1
 6 Power     TATA PROJECTS LTD                    8.55e7      5                2
 7 Power     LARSEN &amp; TOUBRO LTD                  7.95e7      4                1
 8 Power     SHANGHAI ELECTRIC GROUP COMPANY …    7.26e7      4                1
 9 Power     North China Power Engineering Co…    7.25e7      4                2
10 Power     CHINA MACHINERY ENGINEERING CORP…    6.87e7      1                1
11 Transport Jiangxi Transportation Engineeri…    2.51e8      9                2
12 Transport CHINA RAILWAY 18TH BUREAU (GROUP…    1.95e8      6                2
13 Transport CHINA WU YI COMPANY LTD.             1.66e8      7                3
14 Transport SINOHYDRO CORPORATION LIMITED        1.61e8     13                5
15 Transport China Henan International Cooper…    1.53e8      4                2
16 Transport M/S BEIJING CONSTRUCTION ENGINEE…    1.36e8      3                1
17 Transport CRBC                                 1.14e8      2                1
18 Transport CHINA JIANGXI INTERNATIONAL ECON…    1.10e8      8                3
19 Transport HUNAN ROAD AND BRIDGE CONSTRUCTI…    9.83e7      4                1
20 Transport JMC Project (India) Ltd. JV with…    9.52e7      1                1</code></pre>
</div>
</div>
</section>
<section id="top-suppliers-and-footprint" class="level3" data-number="1.22">
<h3 data-number="1.22" class="anchored" data-anchor-id="top-suppliers-and-footprint"><span class="header-section-number">1.22</span> Top suppliers and footprint</h3>
<ul>
<li>Sector-level supplier rankings highlight firms with repeated high-value awards.</li>
<li>Suppliers operating across multiple countries within a sector often reflect global or regional specialization; dominance by a small number of firms raises concentration considerations.</li>
</ul>
<p>9E) Contract size distribution by sector</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sector <span class="sc">%in%</span> priority_sectors),</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> spend_usd)) <span class="sc">+</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">80</span>) <span class="sc">+</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>()) <span class="sc">+</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> sector, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Contract Size Distribution by Sector (log scale)"</span>,</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Award size (USD)"</span>,</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AfDB_Awarded_Contracts_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="contract-size-distribution" class="level3" data-number="1.23">
<h3 data-number="1.23" class="anchored" data-anchor-id="contract-size-distribution"><span class="header-section-number">1.23</span> Contract size distribution</h3>
<ul>
<li>Contract sizes in priority sectors are highly right-skewed, with a small number of very large awards driving total spend.</li>
<li>This reinforces the importance of focusing governance and VfM scrutiny on the upper tail of the distribution.</li>
</ul>
<ol start="10" type="1">
<li>— Integrity / probity risk flags (Red-flag registry)</li>
</ol>
<p>10A) Helper: concentration tables (country/sector) used as flags</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>hhi_calc <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> x <span class="sc">/</span> <span class="fu">sum</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(s<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>conc_country <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_country, bidder_name) <span class="sc">%&gt;%</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">spend =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_country) <span class="sc">%&gt;%</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">country_hhi =</span> <span class="fu">hhi_calc</span>(spend),</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">country_top1 =</span> <span class="fu">max</span>(spend)<span class="sc">/</span><span class="fu">sum</span>(spend),</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">country_top5 =</span> <span class="fu">sum</span>(<span class="fu">sort</span>(spend, <span class="at">decreasing=</span><span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">5</span>, <span class="fu">n</span>())])<span class="sc">/</span><span class="fu">sum</span>(spend),</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>conc_sector <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sector, bidder_name) <span class="sc">%&gt;%</span></span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">spend =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sector) <span class="sc">%&gt;%</span></span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">sector_hhi =</span> <span class="fu">hhi_calc</span>(spend),</span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">sector_top1 =</span> <span class="fu">max</span>(spend)<span class="sc">/</span><span class="fu">sum</span>(spend),</span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">sector_top5 =</span> <span class="fu">sum</span>(<span class="fu">sort</span>(spend, <span class="at">decreasing=</span><span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">5</span>, <span class="fu">n</span>())])<span class="sc">/</span><span class="fu">sum</span>(spend),</span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>10B) Flag 1 — High-value awards under low-competition methods</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>hv_cut <span class="ot">&lt;-</span> <span class="fu">quantile</span>(df<span class="sc">$</span>spend_usd, <span class="fl">0.95</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>flag_hv_lowcomp <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(proc_mode <span class="sc">%in%</span> low_comp_modes, spend_usd <span class="sc">&gt;=</span> hv_cut) <span class="sc">%&gt;%</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">flag =</span> <span class="st">"High-value under low-competition method"</span>,</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>    year, project_country, sector, expense_category, proc_mode,</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>    bidder_name, bidder_nationality,</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>    project_def, loan_number, tender_num, contr_no,</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>    spend_usd</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>10C) Flag 2 — Single supplier dominates a project/loan (≥ 80% of spend)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>proj_supplier_share <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_def, loan_number, bidder_name) <span class="sc">%&gt;%</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">spend =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups=</span><span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_def, loan_number) <span class="sc">%&gt;%</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">project_total =</span> <span class="fu">sum</span>(spend),</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">share =</span> spend <span class="sc">/</span> project_total) <span class="sc">%&gt;%</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>flag_project_dom <span class="ot">&lt;-</span> proj_supplier_share <span class="sc">%&gt;%</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(share <span class="sc">&gt;=</span> <span class="fl">0.80</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">flag =</span> <span class="st">"Single supplier dominates project/loan (&gt;=80% spend)"</span>,</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> <span class="cn">NA_integer_</span>,</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">project_country =</span> <span class="cn">NA_character_</span>,</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">sector =</span> <span class="cn">NA_character_</span>,</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">expense_category =</span> <span class="cn">NA_character_</span>,</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">proc_mode =</span> <span class="cn">NA_character_</span>,</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>    bidder_name,</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">bidder_nationality =</span> <span class="cn">NA_character_</span>,</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>    project_def, loan_number,</span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">tender_num =</span> <span class="cn">NA_character_</span>,</span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">contr_no =</span> <span class="cn">NA_character_</span>,</span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">spend_usd =</span> spend,</span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">extra =</span> <span class="fu">paste0</span>(<span class="st">"Share="</span>, scales<span class="sc">::</span><span class="fu">percent</span>(share))</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>10D) Flag 3 — Fragmentation (many awards + high micro-award share)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>frag_proj <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_def, loan_number) <span class="sc">%&gt;%</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">awards =</span> <span class="fu">n</span>(),</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">spend_total =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_below_50k  =</span> <span class="fu">mean</span>(spend_usd <span class="sc">&lt;</span>  <span class="dv">50000</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_below_100k =</span> <span class="fu">mean</span>(spend_usd <span class="sc">&lt;</span> <span class="dv">100000</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>flag_frag <span class="ot">&lt;-</span> frag_proj <span class="sc">%&gt;%</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(awards <span class="sc">&gt;=</span> <span class="dv">30</span> <span class="sc">&amp;</span> (p_below_50k <span class="sc">&gt;=</span> <span class="fl">0.50</span> <span class="sc">|</span> p_below_100k <span class="sc">&gt;=</span> <span class="fl">0.70</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">flag =</span> <span class="st">"Fragmentation: many awards + high micro-award share"</span>,</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> <span class="cn">NA_integer_</span>,</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">project_country =</span> <span class="cn">NA_character_</span>,</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">sector =</span> <span class="cn">NA_character_</span>,</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">expense_category =</span> <span class="cn">NA_character_</span>,</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">proc_mode =</span> <span class="cn">NA_character_</span>,</span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">bidder_name =</span> <span class="cn">NA_character_</span>,</span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">bidder_nationality =</span> <span class="cn">NA_character_</span>,</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>    project_def, loan_number,</span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">tender_num =</span> <span class="cn">NA_character_</span>,</span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">contr_no =</span> <span class="cn">NA_character_</span>,</span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">spend_usd =</span> spend_total,</span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">extra =</span> <span class="fu">paste0</span>(<span class="st">"awards="</span>, awards,</span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"; &lt;50k="</span>, scales<span class="sc">::</span><span class="fu">percent</span>(p_below_50k),</span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"; &lt;100k="</span>, scales<span class="sc">::</span><span class="fu">percent</span>(p_below_100k))</span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>10E) Flag 4 — Extreme concentration contexts (country/sector)</p>
<p>We’ll mark countries/sectors with HHI &gt; 0.18 OR Top-1 ≥ 50% OR Top-5 ≥ 80% as “high concentration environments”.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>high_conc_countries <span class="ot">&lt;-</span> conc_country <span class="sc">%&gt;%</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country_hhi <span class="sc">&gt;</span> <span class="fl">0.18</span> <span class="sc">|</span> country_top1 <span class="sc">&gt;=</span> <span class="fl">0.50</span> <span class="sc">|</span> country_top5 <span class="sc">&gt;=</span> <span class="fl">0.80</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">extra =</span> <span class="fu">paste0</span>(<span class="st">"HHI="</span>, <span class="fu">round</span>(country_hhi,<span class="dv">3</span>),</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"; Top1="</span>, scales<span class="sc">::</span><span class="fu">percent</span>(country_top1),</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"; Top5="</span>, scales<span class="sc">::</span><span class="fu">percent</span>(country_top5))) <span class="sc">%&gt;%</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(project_country, extra)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>high_conc_sectors <span class="ot">&lt;-</span> conc_sector <span class="sc">%&gt;%</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sector_hhi <span class="sc">&gt;</span> <span class="fl">0.18</span> <span class="sc">|</span> sector_top1 <span class="sc">&gt;=</span> <span class="fl">0.50</span> <span class="sc">|</span> sector_top5 <span class="sc">&gt;=</span> <span class="fl">0.80</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">extra =</span> <span class="fu">paste0</span>(<span class="st">"HHI="</span>, <span class="fu">round</span>(sector_hhi,<span class="dv">3</span>),</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"; Top1="</span>, scales<span class="sc">::</span><span class="fu">percent</span>(sector_top1),</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"; Top5="</span>, scales<span class="sc">::</span><span class="fu">percent</span>(sector_top5))) <span class="sc">%&gt;%</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sector, extra)</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>flag_high_conc_context <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(high_conc_countries, <span class="at">by =</span> <span class="st">"project_country"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">country_extra =</span> extra) <span class="sc">%&gt;%</span></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(high_conc_sectors, <span class="at">by =</span> <span class="st">"sector"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sector_extra =</span> extra) <span class="sc">%&gt;%</span></span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(country_extra) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.na</span>(sector_extra)) <span class="sc">%&gt;%</span></span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">flag =</span> <span class="st">"Award occurs in high-concentration country/sector (context)"</span>,</span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a>    year, project_country, sector, expense_category, proc_mode,</span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a>    bidder_name, bidder_nationality,</span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a>    project_def, loan_number, tender_num, contr_no,</span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a>    spend_usd,</span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">extra =</span> <span class="fu">paste</span>(</span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(<span class="fu">is.na</span>(country_extra), <span class="st">""</span>, <span class="fu">paste0</span>(<span class="st">"Country: "</span>, country_extra)),</span>
<span id="cb97-29"><a href="#cb97-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(<span class="fu">is.na</span>(sector_extra), <span class="st">""</span>, <span class="fu">paste0</span>(<span class="st">"Sector: "</span>, sector_extra)),</span>
<span id="cb97-30"><a href="#cb97-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">sep =</span> <span class="st">" | "</span></span>
<span id="cb97-31"><a href="#cb97-31" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb97-32"><a href="#cb97-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb97-33"><a href="#cb97-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(spend_usd)) <span class="sc">%&gt;%</span></span>
<span id="cb97-34"><a href="#cb97-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">200</span>)  <span class="co"># keep registry manageable</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>10F) Combine into one registry</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>red_flag_registry <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  flag_hv_lowcomp,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  flag_project_dom,</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  flag_frag,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  flag_high_conc_context</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(spend_usd))</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>red_flag_registry <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">250</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 250 × 14
   flag       year project_country sector expense_category proc_mode bidder_name
   &lt;chr&gt;     &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;  &lt;chr&gt;            &lt;chr&gt;     &lt;chr&gt;      
 1 Single s…    NA &lt;NA&gt;            &lt;NA&gt;   &lt;NA&gt;             &lt;NA&gt;      Consortium…
 2 Single s…    NA &lt;NA&gt;            &lt;NA&gt;   &lt;NA&gt;             &lt;NA&gt;      SAKHALIVE …
 3 Award oc…  2023 Eswatini        Agric… WORKS            ICB       SAKHALIVE …
 4 Single s…    NA &lt;NA&gt;            &lt;NA&gt;   &lt;NA&gt;             &lt;NA&gt;      M/S DONGFA…
 5 Single s…    NA &lt;NA&gt;            &lt;NA&gt;   &lt;NA&gt;             &lt;NA&gt;      JMC Projec…
 6 Single s…    NA &lt;NA&gt;            &lt;NA&gt;   &lt;NA&gt;             &lt;NA&gt;      Siemens Mo…
 7 Single s…    NA &lt;NA&gt;            &lt;NA&gt;   &lt;NA&gt;             &lt;NA&gt;      SINOHYDRO …
 8 Single s…    NA &lt;NA&gt;            &lt;NA&gt;   &lt;NA&gt;             &lt;NA&gt;      Kopano Ke …
 9 Award oc…  2022 South Africa    Water… WORKS            ICB       Kopano Ke …
10 Single s…    NA &lt;NA&gt;            &lt;NA&gt;   &lt;NA&gt;             &lt;NA&gt;      CRBC       
# ℹ 240 more rows
# ℹ 7 more variables: bidder_nationality &lt;chr&gt;, project_def &lt;chr&gt;,
#   loan_number &lt;chr&gt;, tender_num &lt;chr&gt;, contr_no &lt;chr&gt;, spend_usd &lt;dbl&gt;,
#   extra &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="integrity-probity-screening-registry-evidence-based" class="level3" data-number="1.24">
<h3 data-number="1.24" class="anchored" data-anchor-id="integrity-probity-screening-registry-evidence-based"><span class="header-section-number">1.24</span> Integrity / probity screening registry (evidence-based)</h3>
<p>This dataset does not include bidder counts, evaluation scores, or timing, so the “red flags” below are <strong>screening indicators</strong> rather than proof of wrongdoing. They are designed to prioritize follow-up questions and document review.</p>
<p>Flags used: - <strong>High-value awards under low-competition methods</strong> (top 5% of award sizes within DNP/SHL/NSH/ISH-type modes) - <strong>Single supplier dominance</strong> within a project/loan (≥ 80% of project spend) - <strong>Fragmentation</strong> (projects/loans with many awards and high shares of micro-awards under common thresholds) - <strong>High concentration context</strong> (awards occurring in countries/sectors with high HHI or high top-supplier dominance)</p>
<p>These indicators provide a practical, defensible starting point for deeper governance and value-for-money review.</p>
<ol start="11" type="1">
<li>Currency conversion sanity check (data quality / assurance) Goal: compare Cont. Am. (UAC) vs Equiv. (USD) to compute an implied conversion rate and flag anomalies.</li>
</ol>
<p>11A) Compute implied conversion rate at award level</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>fx_award <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(cont_uac), cont_uac <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(spend_usd), spend_usd <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">implied_rate =</span> spend_usd <span class="sc">/</span> cont_uac)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fx_award<span class="sc">$</span>implied_rate)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.309   1.331   1.342   1.368   1.400   1.440 </code></pre>
</div>
</div>
<p>11B) Summarize implied rates by Year × Country (median + p10/p90)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>fx_summary <span class="ot">&lt;-</span> fx_award <span class="sc">%&gt;%</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, project_country) <span class="sc">%&gt;%</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">rate_median =</span> <span class="fu">median</span>(implied_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">rate_p10 =</span> <span class="fu">quantile</span>(implied_rate, <span class="fl">0.10</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">rate_p90 =</span> <span class="fu">quantile</span>(implied_rate, <span class="fl">0.90</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>fx_summary <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">50</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 6
    year project_country     n rate_median rate_p10 rate_p90
   &lt;int&gt; &lt;chr&gt;           &lt;int&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  2024 Multi-Countries   861        1.34     1.34     1.34
 2  2023 Multi-Countries   711        1.33     1.33     1.33
 3  2021 Multi-Countries   654        1.44     1.44     1.44
 4  2022 Multi-Countries   643        1.40     1.40     1.40
 5  2020 Multi-Countries   639        1.38     1.38     1.38
 6  2025 Multi-Countries   508        1.31     1.31     1.31
 7  2021 Senegal           234        1.44     1.44     1.44
 8  2023 Senegal           227        1.33     1.33     1.33
 9  2023 Tunisia           203        1.33     1.33     1.33
10  2025 Nigeria           198        1.31     1.31     1.31
# ℹ 40 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>fx_year <span class="ot">&lt;-</span> fx_award <span class="sc">%&gt;%</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">rate_median =</span> <span class="fu">median</span>(implied_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fx_year, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> rate_median)) <span class="sc">+</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Median Implied Conversion Factor by Year"</span>,</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"USD / UAC (implied)"</span></span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AfDB_Awarded_Contracts_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>11C) Outlier report (award-level)</p>
<p>We flag extreme implied rates using robust quantiles (1st/99th percentiles).</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>lo <span class="ot">&lt;-</span> <span class="fu">quantile</span>(fx_award<span class="sc">$</span>implied_rate, <span class="fl">0.01</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>hi <span class="ot">&lt;-</span> <span class="fu">quantile</span>(fx_award<span class="sc">$</span>implied_rate, <span class="fl">0.99</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>fx_outliers <span class="ot">&lt;-</span> fx_award <span class="sc">%&gt;%</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(implied_rate <span class="sc">&lt;</span> lo <span class="sc">|</span> implied_rate <span class="sc">&gt;</span> hi) <span class="sc">%&gt;%</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>    year, project_country, sector, expense_category, proc_mode,</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>    bidder_name, bidder_nationality,</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>    project_def, loan_number, tender_num, contr_no,</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>    cont_uac, spend_usd,</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    implied_rate</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(implied_rate))</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>fx_outliers <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">200</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 180 × 14
    year project_country sector          expense_category proc_mode bidder_name 
   &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;            &lt;chr&gt;     &lt;chr&gt;       
 1  2021 Angola          Agriculture     SERVICES         DNP       Victor Fran…
 2  2021 Angola          Water Sup/Sanit GOODS            ICB       QINGDAO INS…
 3  2021 Angola          Water Sup/Sanit GOODS            ICB       HOMT ESPANA…
 4  2021 Angola          Power           GOODS            SHL       UNOPS       
 5  2021 Angola          Multi-Sector    SERVICES         DNP       Boston Cons…
 6  2021 Angola          Multi-Sector    SERVICES         SHL       Mr. Tiago L…
 7  2021 Burkina Faso    Agriculture     SERVICES         NSH       ANET PLUS   
 8  2021 Burkina Faso    Multi-Sector    SERVICES         NSH       TASSEMBEDO …
 9  2021 Burundi         Transport       SERVICES         SHL       CERPED-SPRL 
10  2021 Benin           Agriculture     SERVICES         NCB       GROUPEMENT …
# ℹ 170 more rows
# ℹ 8 more variables: bidder_nationality &lt;chr&gt;, project_def &lt;chr&gt;,
#   loan_number &lt;chr&gt;, tender_num &lt;chr&gt;, contr_no &lt;chr&gt;, cont_uac &lt;dbl&gt;,
#   spend_usd &lt;dbl&gt;, implied_rate &lt;dbl&gt;</code></pre>
</div>
</div>
<p>11D) Country/year “instability” flags (wide p10–p90 bands)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>fx_instability <span class="ot">&lt;-</span> fx_summary <span class="sc">%&gt;%</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">spread =</span> rate_p90 <span class="sc">-</span> rate_p10) <span class="sc">%&gt;%</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(spread))</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>fx_instability <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">50</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 7
    year project_country     n rate_median rate_p10 rate_p90   spread
   &lt;int&gt; &lt;chr&gt;           &lt;int&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  2020 Egypt               9        1.38     1.38     1.38 4.44e-16
 2  2020 Eritrea             7        1.38     1.38     1.38 4.44e-16
 3  2024 Algeria             4        1.34     1.34     1.34 4.44e-16
 4  2024 Somalia            85        1.34     1.34     1.34 2.22e-16
 5  2021 Angola             51        1.44     1.44     1.44 2.22e-16
 6  2025 Ethiopia           23        1.31     1.31     1.31 2.22e-16
 7  2022 Comoros            19        1.40     1.40     1.40 2.22e-16
 8  2023 Sierra Leone       18        1.33     1.33     1.33 2.22e-16
 9  2022 Congo CG           17        1.40     1.40     1.40 2.22e-16
10  2025 Mauritania         14        1.31     1.31     1.31 2.22e-16
# ℹ 40 more rows</code></pre>
</div>
</div>
</section>
<section id="currency-conversion-sanity-check-uac-usd" class="level3" data-number="1.25">
<h3 data-number="1.25" class="anchored" data-anchor-id="currency-conversion-sanity-check-uac-usd"><span class="header-section-number">1.25</span> Currency conversion sanity check (UAC → USD)</h3>
<ul>
<li>We compute an implied conversion factor as <strong>USD-equivalent / UAC amount</strong> for each award, then summarize patterns by year and country.</li>
<li>Stable implied rates within a year-country group are a basic signal of consistent conversion; unusually wide spreads or extreme outliers may indicate data issues (e.g., wrong currency tagging, decimal shifts, or conversion errors).</li>
<li>The outlier list is intended as a <strong>data quality follow-up</strong> tool and supports a transparent “assurance notes” section in reporting.</li>
</ul>
<ol start="12" type="1">
<li>Network view (“who supplies whom”)</li>
</ol>
<p>12A) Core supply corridors (Country → Supplier Nationality)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>corridors <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(bidder_nationality), bidder_nationality <span class="sc">!=</span> <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_country, bidder_nationality) <span class="sc">%&gt;%</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">spend_usd =</span> <span class="fu">sum</span>(spend_usd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">awards =</span> <span class="fu">n</span>(),</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(spend_usd))</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>corridors <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">50</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 4
   project_country bidder_nationality   spend_usd awards
   &lt;chr&gt;           &lt;chr&gt;                    &lt;dbl&gt;  &lt;int&gt;
 1 Multi-Countries China              1225385836.     84
 2 Nigeria         Nigeria             693274310.    910
 3 Senegal         Senegal             593480873.    986
 4 Tunisia         Tunisia             425291169.    949
 5 Tanzania        China               400451348.     16
 6 Angola          China               353679889.     30
 7 Cameroon        Cameroon            305016177.    178
 8 Kenya           China               296216676.     21
 9 Morocco         Morocco             277011225.    256
10 Côte D'Ivoire   Côte D'Ivoire       276313787.    743
# ℹ 40 more rows</code></pre>
</div>
</div>
<p>“Top corridors” table (management-ready)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>top_corridors <span class="ot">&lt;-</span> corridors <span class="sc">%&gt;%</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">25</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>top_corridors</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 × 4
   project_country bidder_nationality   spend_usd awards
   &lt;chr&gt;           &lt;chr&gt;                    &lt;dbl&gt;  &lt;int&gt;
 1 Multi-Countries China              1225385836.     84
 2 Nigeria         Nigeria             693274310.    910
 3 Senegal         Senegal             593480873.    986
 4 Tunisia         Tunisia             425291169.    949
 5 Tanzania        China               400451348.     16
 6 Angola          China               353679889.     30
 7 Cameroon        Cameroon            305016177.    178
 8 Kenya           China               296216676.     21
 9 Morocco         Morocco             277011225.    256
10 Côte D'Ivoire   Côte D'Ivoire       276313787.    743
# ℹ 15 more rows</code></pre>
</div>
</div>
</section>
<section id="procurement-supply-corridors-country-supplier-nationality" class="level3" data-number="1.26">
<h3 data-number="1.26" class="anchored" data-anchor-id="procurement-supply-corridors-country-supplier-nationality"><span class="header-section-number">1.26</span> Procurement supply corridors (country → supplier nationality)</h3>
<ul>
<li>This table shows the strongest <strong>procurement corridors</strong>, linking project countries to the nationalities of winning suppliers.</li>
<li>Heavy reliance on a small number of external source countries can indicate specialization or regional integration, but also highlights <strong>dependence risks</strong> if supplier bases are narrow.</li>
</ul>
<p>12B) Country-centric corridor view (who supplies each country)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>country_corridors <span class="ot">&lt;-</span> corridors <span class="sc">%&gt;%</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_country) <span class="sc">%&gt;%</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">share =</span> spend_usd <span class="sc">/</span> <span class="fu">sum</span>(spend_usd)) <span class="sc">%&gt;%</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(project_country, <span class="fu">desc</span>(spend_usd))</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>country_corridors <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">50</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 893 × 5
# Groups:   project_country [55]
   project_country bidder_nationality  spend_usd awards   share
   &lt;chr&gt;           &lt;chr&gt;                   &lt;dbl&gt;  &lt;int&gt;   &lt;dbl&gt;
 1 Algeria         Algeria               319485.      6 0.400  
 2 Algeria         Portugal              201670.      1 0.252  
 3 Algeria         Germany               179201.      1 0.224  
 4 Algeria         Tunisia                98858.      2 0.124  
 5 Angola          China              353679889.     30 0.559  
 6 Angola          Angola             141755024.    190 0.224  
 7 Angola          India              109316498.     13 0.173  
 8 Angola          Portugal            11616882.     38 0.0184 
 9 Angola          Brazil               5052721.      3 0.00799
10 Angola          Nigeria              3392126.      3 0.00536
# ℹ 883 more rows</code></pre>
</div>
</div>
<p>Top 5 Supplier Nationalities per country</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>country_corridors <span class="sc">%&gt;%</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(project_country) <span class="sc">%&gt;%</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 272 × 5
   project_country bidder_nationality  spend_usd awards   share
   &lt;chr&gt;           &lt;chr&gt;                   &lt;dbl&gt;  &lt;int&gt;   &lt;dbl&gt;
 1 Algeria         Algeria               319485.      6 0.400  
 2 Algeria         Portugal              201670.      1 0.252  
 3 Algeria         Germany               179201.      1 0.224  
 4 Algeria         Tunisia                98858.      2 0.124  
 5 Angola          China              353679889.     30 0.559  
 6 Angola          Angola             141755024.    190 0.224  
 7 Angola          India              109316498.     13 0.173  
 8 Angola          Portugal            11616882.     38 0.0184 
 9 Angola          Brazil               5052721.      3 0.00799
10 Benin           China              154237527.     15 0.447  
# ℹ 262 more rows</code></pre>
</div>
</div>
</section>
<section id="country-sourcing-profiles" class="level3" data-number="1.27">
<h3 data-number="1.27" class="anchored" data-anchor-id="country-sourcing-profiles"><span class="header-section-number">1.27</span> Country sourcing profiles</h3>
<ul>
<li>Each project country exhibits a distinct sourcing profile, combining domestic suppliers and a small number of key external supplier nationalities.</li>
<li>Concentration in a few supplier countries strengthens the case for targeted supplier-market development or diversification strategies.</li>
</ul>
<p>12C) Network visualization</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>  country_corridors <span class="sc">%&gt;%</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(project_country) <span class="sc">%&gt;%</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>),</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> bidder_nationality, <span class="at">y =</span> spend_usd)</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> project_country, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>()) <span class="sc">+</span></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Top Supplier Nationalities by Project Country"</span>,</span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Supplier nationality"</span>,</span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Spend (USD)"</span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AfDB_Awarded_Contracts_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="network-view-who-supplies-whom" class="level3" data-number="1.28">
<h3 data-number="1.28" class="anchored" data-anchor-id="network-view-who-supplies-whom"><span class="header-section-number">1.28</span> Network view: who supplies whom</h3>
<ul>
<li>The supply-network view highlights the structure of procurement relationships across countries and supplier nationalities.</li>
<li>Strong corridors reflect specialization and regional trade patterns, while sparse networks may indicate thin markets or limited competition.</li>
<li>This perspective complements concentration and domestic-share analysis by showing <strong>dependency paths</strong>, not just aggregate shares.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/tanmaysharma96\.github\.io\/STA9750-2025-FALL\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>